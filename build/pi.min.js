/*! pi 2014-03-11 */
var feature={addEventListener:!!window.addEventListener,querySelectorAll:!!document.querySelectorAll,classList:!!document.documentElement.classList,DEBUG:!0},pi=document.querySelector.bind(document),pii=document.querySelectorAll.bind(document);pi.debug=function(a,b){"use strict";feature.DEBUG&&console.debug("["+a+"] "+b)},Element.prototype.on=Element.prototype.addEventListener,Element.prototype.rm=Element.prototype.removeEventListener,NodeList.prototype.on=function(a,b){"use strict";var c=0;for(c=0;c<this.length;c++)this.item(c).addEventListener(a,b,!1)},NodeList.prototype.rm=function(a,b){"use strict";var c=0;for(c=0;c<this.length;c++)this.item(c).removeEventListener(a,b,!1)},feature.classList&&(pi.classAdd=function(a,b){"use strict";"string"==typeof a&&(a=pi(a)),a.classList.add(b)},pi.classDel=function(a,b){"use strict";"string"==typeof a&&(a=pi(a)),a.classList.remove(b)},pi.classHas=function(a,b){"use strict";"string"==typeof a&&(a=pi(a)),a.classList.contains(b)},pi.classToggle=function(a,b){"use strict";"string"==typeof a&&(a=pi(a)),a.classList.toggle(b)}),pii.classAdd=function(a,b){"use strict";var c;if("string"==typeof a&&(a=pii(a)),"Object"!=typeof a&&a.length<=0)return!1;for(c=0;c<a.length;c++)pi.classAdd(a[c],b)},pii.classDel=function(a,b){"use strict";var c;if("string"==typeof a&&(a=pii(a)),"Object"!=typeof a&&a.length<=0)return!1;for(c=0;c<a.length;c++)pi.classDel(a[c],b)},pii.classToggle=function(a,b){"use strict";var c;if("string"==typeof a&&(a=pii(a)),"Object"!=typeof a&&a.length<=0)return!1;for(c=0;c<a.length;c++)pi.classToggle(a[c],b)},pi.ready=function(a){"use strict";document.addEventListener("DOMContentLoaded",a(),!1)};var topics={};pi.pub=function(a,b){"use strict";if(topics[a]){var c,d,e=topics[a],f=b||[];for(c=0,d=e.length;d>c;c++)pi.debug("PUB",a),e[c].apply(pi,f)}},pi.sub=function(a,b){"use strict";return topics[a]||(topics[a]=[]),pi.debug("SUB",a),topics[a].push(b),{topic:a,callback:b}},pi.unsub=function(a){"use strict";var b,c,d=a.topic,e=[];if(topics[d])for(e=topics[d],b=0,c=e.length;c>b;b++)e[b]===a.callback&&(pi.debug("DEL",d),e.splice(b,1))},pi.storage=function(){"use strict";return{set:function(a,b){try{localStorage.setItem(a,b)}catch(c){if("QUOTA_EXCEEDED_ERR"===c.name)throw new Exception(c.name)}},get:function(a){return localStorage.getItem(a)},del:function(a){"undefined"==typeof a?localStorage.clear():localStorage.removeItem(a)},cache:function(a,b,c){var d=(new Date).valueOf(),e="pic",f=0,g={};return g=JSON.parse(this.get(e)||"{}"),"undefined"==typeof b?(f=d-("undefined"!=typeof g[a]?g[a].ttl:0),pi.debug("AGE",f+" key: "+a),!g[a]||null===g||f>1?(this.del(g[a]),!1):g[a].d):(g[a]={d:b,ttl:d+c},void this.set(e,JSON.stringify(g)))}}}(),pi.append=function(a,b,c){"use strict";switch(a=pi(a),b=pi(b),c){case"top":b.parentNode.insertBefore(a,b);break;case"down":b.parentNode.insertBefore(a,b.nextSibling);break;default:b.appendChild(a)}},pi.ajax=function(a){"use strict";var b=new XMLHttpRequest,c=pi.storage.cache(a.type+a.url);return c?void a.success(c):(b.open(a.type,a.url,!0),b.onreadystatechange=function(){return 4!==b.readyState||200!==b.status?void("undefined"!=typeof a.error&&a.error(b.responseText)):(pi.storage.cache(a.type+a.url,b.responseText,a.ttl||6e4),void a.success(b.responseText))},void b.send(a.params||""))};